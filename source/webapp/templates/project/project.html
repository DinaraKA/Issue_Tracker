{% extends 'base.html' %}
{% block title %}{{ project.name}}{% endblock %}
{% block menu %}
    {% if perms.webapp.change_project %}
        <li><a href="{% url 'webapp:project_update' project.pk %}">Update</a></li>
    {% endif %}
    {% if perms.webapp.delete_project %}
        <li><a href="{% url 'webapp:project_delete' project.pk %}">Delete</a></li>
    {% endif %}
{% endblock %}
{% block content %}
    <div class="jumbotron jumbotron-fluid">
        <div class="container">
            <h3>Project: {{ project.name}}</h3>
            <p class="lead">{{ project.description }}</p>
            <hr class="my-4">
            <p><b>Users: </b></p>
                {% for team in team_users %}
                    <p>{{ team.user.username }} - started at {{ team.start|date:'Y-m-d' }}</p>
                {% endfor %}
            <p class="task-links">
                {% if perms.webapp.change_team and perms.webapp.add_team %}
                    <a href="{% url 'webapp:project_add_user' project.pk %}">Edit team</a>
                {% endif %}
            </p>
            <p><b>Created date: </b>{{ project.created_at|date:'Y-m-d H:i:s' }}</p>
            <hr/>
            <h3>Issues:</h3>
            {% if is_paginated %}
                {% include 'partial/pagination.html' %}
            {% endif %}
            <div class="issue-list">
                {% for task in tasks %}
                    <hr>
                    <div class="task">
                        <p><b>{{ forloop.counter }}. {{ task.summary }} created by - {{ task.created_by }}, created at {{ task.created_at|date:'d.m.Y H:i:s' }}</b></p>
                        <div class="pre">{{ task.description }}</div>
                        <div>Assigned to: {{ task.assigned_to }}</div>
                        <p class="task-links">
                            {% if perms.webapp.change_task %}
                                <a href="{% url 'webapp:task_update' task.pk %}">Edit</a>
                            {% endif %}
                            {% if perms.webapp.delete_task %}
                                <a href="{% url 'webapp:task_delete' task.pk %}">Delete</a>
                            {% endif %}
                        </p>
                    </div>
                {% empty %}
                    <p>No issues yet.</p>
                {% endfor %}
            </div>
            {% if is_paginated %}
                {% include 'partial/pagination.html' %}
            {% endif %}
            {% if perms.webapp.add_task %}
                <a href="{% url 'webapp:project_task_create' project.pk %}">Add task</a>
            {% endif %}
        </div>
    </div>
{% endblock %}

